Current cuda device:  0
[Hydra-visLogging]  True
[Hydra-receptiveField]  False
[Hydra-maskDuplicate] {'enable': True, '_target_': 'utils.data.duplicate_dataset.DuplicateMaskDataset', 'accel_cfgs': [{'accel': 4}, {'accel': 8}], 'bundle_path': '/home/swpants05/Desktop/2025_FastMri/2025_GeekSeek//metaData/precomputed_masks.npz'}
[Hydra] training: accum_steps=2 checkpointing=False amp_enabled=True
[Hydra] grad_accum_scheduler ÌôúÏÑ±Ìôî ‚Üí milestones=[{'epoch': 0, 'steps': 2}, {'epoch': 5, 'steps': 10}, {'epoch': 25, 'steps': 16}]
[Hydra] grad_clip: enable=True max_norm=1.0 norm_type=2
[Hydra-eval] {'enable': False, 'stages': [{'epoch': 10, 'ssim': 0.9}, {'epoch': 20, 'ssim': 0.95}, {'epoch': 25, 'ssim': 0.96}]}
[Hydra-eval] early_enabled=False, stage_table={10: 0.9, 20: 0.95, 25: 0.96}
self._lksa_applied :  True
self._lksa_applied :  True
[Hydra-model] model_cfg={'_target_': 'utils.model.feature_varnet.FlexibleCascadeVarNet', 'variant': 'dlka', 'cascade_counts': [2, 4, 6], 'feature_chans': 9, 'unet_chans': 32, 'pools': 4, 'sens_chans': 8, 'sens_pools': 4, 'mask_center': True, 'kspace_mult_factor': 1000000.0, 'crop_size': 'none'}
[Hydra] loss_func ‚ñ∂ SSIML1Loss(
  (ssim_base): SSIMLoss()
)
[Hydra] Optimizer ‚ñ∂ NAdam
[Hydra] Scheduler ‚ñ∂ <torch.optim.lr_scheduler.ExponentialLR object at 0x7765ebf09e80>
[DeepSpeed] use_deepspeed False
{'enable': False, 'config': {'train_micro_batch_size_per_gpu': 1, 'dist_init_required': False, 'optimizer': {'type': 'Adam', 'params': {'lr': 0.001, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0}}, 'zero_optimization': {'stage': 1, 'offload_optimizer': {'device': 'cpu'}}, 'fp16': {'enabled': False}, 'scheduler': {'type': 'WarmupCosineLR', 'params': {'warmup_min_ratio': 0.001, 'cos_min_ratio': 0.1, 'warmup_num_steps': 14811, 'total_num_steps': 148110}}}}
[Hydra] AugmenterÎ•º ÏÉùÏÑ±Ìï©ÎãàÎã§.
[MRAug] max_epochs :  30
{'_target_': 'utils.augmentations.mraugmenter.MRAugmenter', 'aug_on': True, 'aug_strength': 0.7, 'aug_delay': 5, 'weight_dict': {'fliph': 0.5, 'flipv': 0.5, 'rotate': 0.25, 'scale': 0.5, 'shift': 0.2, 'shear': 0.5}, 'aug_schedule_mode': 'epoch', 'aug_schedule_type': 'ramp', 'max_epochs': 30, 'val_loss_window_size': 5, 'val_loss_grad_start': -0.05, 'val_loss_grad_plateau': -0.001, 'aug_exp_decay': 6.0, 'max_rotation_angle': 15.0, 'scale_range': [0.85, 1.15], 'shift_extent': 5.0, 'max_shear_angle': 10.0}
[Hydra] mask_augmenter :  True
[Mask Aug] max_epochs :  30
{'enable': True, '_target_': 'utils.augmentations.maskaugmenter.MaskAugmenter', 'aug_on': True, 'aug_strength': 0.7, 'aug_delay': 5, 'aug_schedule_mode': 'epoch', 'aug_schedule_type': 'ramp', 'max_epochs': 30, 'val_loss_window_size': 5, 'val_loss_grad_start': -0.05, 'val_loss_grad_plateau': -0.001, 'aug_exp_decay': 6.0, 'mask_specs': {'equispaced': {'prob': 0.4, 'accel': [4, 8], 'cf': [0.07, 0.1]}, 'equispaced_fraction': {'prob': 0.3, 'accel': [4, 8], 'cf': [0.07, 0.1]}, 'random': {'prob': 0.2, 'accel': [4, 8], 'cf': [0.07, 0.1]}, 'magic_fraction': {'prob': 0.1, 'accel': [4, 8], 'cf': [0.07, 0.1]}}, 'allow_any_combination': True}
[Resume] None
/home/swpants05/Desktop/2025_FastMri/2025_GeekSeek/utils/learning/train_part.py:515: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler(enabled=amp_enabled)
/home/swpants05/Desktop/2025_FastMri/Data/train
/home/swpants05/Desktop/2025_FastMri/Data/val
[Hydra-eval] {'enable': True, 'every_n_epochs': 1, 'batch_size': 1, 'leaderboard_root': '/home/swpants05/Desktop/2025_FastMri/Data/leaderboard/', 'output_key': 'reconstruction'}
[Hydra-eval] lb_enable=True, lb_every=1
Epoch # 0 ............... fivarnet_test ...............
Val  [ 0/30]:   0%|                           | 0/863 [00:00<?, ?it/s]/home/swpants05/Desktop/2025_FastMri/2025_GeekSeek/utils/model/feature_varnet/blocks.py:197: UserWarning: where received a uint8 condition tensor. This behavior is deprecated and will be removed in a future version of PyTorch. Use a boolean condition instead. (Triggered internally at /pytorch/aten/src/ATen/native/TensorCompare.cpp:611.)
  torch.where(
/home/swpants05/miniconda3/envs/fmri/lib/python3.13/site-packages/torch/optim/lr_scheduler.py:182: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
loss file saved! /home/swpants05/Desktop/2025_FastMri/result/fivarnet_test/val_loss_log
  warnings.warn(
visual Logging...
[34m[1mwandb[0m: [33mWARNING[0m Saving files without folders. If you want to preserve subdirectories pass base_path to wandb.save, i.e. wandb.save("/mnt/folder/file.h5", base_path="/mnt")
[LeaderBoard] Epoch 1: reconstruct & eval ÏãúÏûë
[acc4] save ‚Üí /home/swpants05/Desktop/2025_FastMri/result/fivarnet_test/reconstructions_leaderboard/acc4
self._lksa_applied :  True
self._lksa_applied :  True
checkpoint_epoch :  1 best_val_loss :  0.15401196479797363
Traceback (most recent call last):                                              
[acc8] save ‚Üí /home/swpants05/Desktop/2025_FastMri/result/fivarnet_test/reconstructions_leaderboard/acc8
self._lksa_applied :  True
self._lksa_applied :  True
checkpoint_epoch :  1 best_val_loss :  0.15401196479797363
[LeaderBoard] acc4=0.8621  acc8=0.8434  mean=0.8527  (7.1 min)

@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@NewRecord@@@@@@@@@@@@@@@@@@@@@@@@@@@@
ForwardTime = 0.6034s
Epoch # 1 ............... fivarnet_test ...............
  File "/home/swpants05/Desktop/2025_FastMri/2025_GeekSeek/main.py", line 124, in <module>
    main()
    ~~~~^^
  File "/home/swpants05/miniconda3/envs/fmri/lib/python3.13/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
    ~~~~~~~~~~^
        args=args,
        ^^^^^^^^^^
    ...<3 lines>...
        config_name=config_name,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/swpants05/miniconda3/envs/fmri/lib/python3.13/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
    ~~~~~~~~^
        run=args.run,
        ^^^^^^^^^^^^^
    ...<5 lines>...
        overrides=overrides,
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/swpants05/miniconda3/envs/fmri/lib/python3.13/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
    ~~~~~~~~~~~~~~^
        lambda: hydra.run(
        ^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
        )
        ^
    )
    ^
  File "/home/swpants05/miniconda3/envs/fmri/lib/python3.13/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/home/swpants05/miniconda3/envs/fmri/lib/python3.13/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
            ~~~~~~~~~^
        config_name=config_name,
        ^^^^^^^^^^^^^^^^^^^^^^^^
        task_function=task_function,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        overrides=overrides,
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/swpants05/miniconda3/envs/fmri/lib/python3.13/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
        hydra_context=HydraContext(
    ...<6 lines>...
        configure_logging=with_log_configuration,
    )
  File "/home/swpants05/miniconda3/envs/fmri/lib/python3.13/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
                       ~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/swpants05/Desktop/2025_FastMri/2025_GeekSeek/main.py", line 117, in main
    train(args)   # utils.learning.train_part.train Ìò∏Ï∂ú :contentReference[oaicite:2]{index=2}
    ~~~~~^^^^^^
  File "/home/swpants05/Desktop/2025_FastMri/2025_GeekSeek/utils/learning/train_part.py", line 584, in train
    val_loss,val_ssim, num_subjects, reconstructions, targets, inputs, val_time = validate(args, model, val_loader,
                                                                                  ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                                    MetricLog_val, epoch,
                                                                                    ^^^^^^^^^^^^^^^^^^^^^
                                                                                    loss_type, ssim_metric)
                                                                                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/swpants05/Desktop/2025_FastMri/2025_GeekSeek/utils/learning/train_part.py", line 211, in validate
    reconstructions[fnames[i]][int(slices[i])] = output[i].cpu().numpy()
                                                 ~~~~~~~~~~~~~^^
KeyboardInterrupt
